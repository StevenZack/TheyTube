<!DOCTYPE html>
<html>
<head>
	<title></title>
	<link rel="stylesheet" type="text/css" href="mdl/icon.css">
	<link rel="stylesheet" type="text/css" href="mdl/material.min.css">
	<script src="mdl/material.min.js"></script>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
  <script type="text/javascript">
  		window.serverAddr='localhost:8090'
  		function setCookie(cname,cvalue,exdays){
  		  var d = new Date();
  		  d.setTime(d.getTime()+(exdays*24*60*60*1000));
  		  var expires = "expires="+d.toGMTString();
  		  document.cookie = cname + "=" + cvalue + "; " + expires;
  		}
  		function getCookie(cname){
  		  var name = cname + "=";
  		  var ca = document.cookie.split(';');
  		  for(var i=0; i<ca.length; i++) 
  		  {
  		    var c = ca[i].trim();
  		    if (c.indexOf(name)==0) return c.substring(name.length,c.length);
  		  }
  		  return "";
  		}
  		function login() {
  			var obj=new Object()
  			obj.Email=document.getElementById("login-email").value
  			obj.Password=document.getElementById("login-password").value
  			if (obj.Email=="") {
  				ons.notification.alert('Email不能为空')
  				return
  			}
  			if (obj.Password=="") {
  				ons.notification.alert("密码不能为空")
  				return
  			}
  			var me=document.getElementById("login-submit")
  			me.disabled='disabled'
  			document.getElementById('login-progress').style.display = 'block'
  			var ws=new WebSocket("ws://"+window.serverAddr+"/wsLogin")
  			ws.onopen=function(evt) {
  				console.log('on open')
  				ws.send(JSON.stringify(obj))
  			}
  			ws.onmessage=function(evt) {
  				console.log(evt.data)
  				var obj=JSON.parse(evt.data)
  				if (obj.State=="OK") {
  					setCookie("TheyTubeSessionID",obj.Info,365)
  					location.href='/'
  				}else if (obj.State=="ERR") {
  					ons.notification.alert(obj.Info)
  				}
  				ws.close()
  			}
			  ws.onclose=function(evt){
				  console.log('on close')
				  document.getElementById('login-progress').style.display = 'none'
  				me.disabled=''
        }
        ws.onerror=function(evt){
        		console.log(evt.data)
        		ons.notification.alert("未联网")
        }
  		}
  		function register() {
  			var obj=new Object()
  			obj.Email=document.getElementById("register-email").value
  			obj.Password=document.getElementById("register-password").value
  			if (obj.Email=="") {
  				ons.notification.alert('Email不能为空')
  				return
  			}
  			if (obj.Password=="") {
  				ons.notification.alert("密码不能为空")
  				return
  			}
  			var me=document.getElementById("register-submit")
  			me.disabled='disabled'
  			document.getElementById('register-progress').style.display = 'block'
  			var ws=new WebSocket("ws://"+window.serverAddr+"/wsRegister")
  			ws.onopen=function(evt) {
  				console.log('on open')
  				ws.send(JSON.stringify(obj))
  			}
  			ws.onmessage=function(evt) {
  				var obj=JSON.parse(evt.data)
  				if (obj.State=="OK") {
  					setCookie("TheyTubeSessionID",obj.Info,365)
  					location.href='/'
  				}else if (obj.State=="ERR") {
  					ons.notification.alert(obj.Info)
  				}
  				ws.close()
  			}
			 ws.onclose=function(evt){
				console.log('on close')
				document.getElementById('register-progress').style.display = 'none'
  				me.disabled=''
        	}
        	ws.onerror=function(evt){
        		console.log(evt.data)
        		ons.notification.alert("未联网")
        }
  		}
  		function doOnLoad() {
  			console.log('do on load')
  		}
  		setTimeout('doOnLoad()', 1000)
  </script>
  <style>
	</style>
</head>
<body>
<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
  <header class="mdl-layout__header">
    <div class="mdl-layout__header-row">
      <span class="mdl-layout-title" style="margin-left: -50px;">TheyTube</span>
      <div class="mdl-layout-spacer"></div>
      <div class="mdl-textfield mdl-js-textfield mdl-textfield--expandable
                  mdl-textfield--floating-label mdl-textfield--align-right">
        <label class="mdl-button mdl-js-button mdl-button--icon"
               for="fixed-header-drawer-exp">
          <i class="material-icons">search</i>
        </label>
        <div class="mdl-textfield__expandable-holder">
          <input class="mdl-textfield__input" type="text" name="sample"
                 id="fixed-header-drawer-exp">
        </div>
      </div>
    </div>
  </header>
  <main class="mdl-layout__content">
    <div class="page-content">
    	<div class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">
		  <div class="mdl-tabs__tab-bar">
		      <a href="#starks-panel" class="mdl-tabs__tab is-active">Starks</a>
		      <a href="#lannisters-panel" class="mdl-tabs__tab">Lannisters</a>
		      <a href="#targaryens-panel" class="mdl-tabs__tab">Targaryens</a>
		  </div>

		  <div class="mdl-tabs__panel is-active" id="starks-panel">
		    <ul>
		      <li>Eddard</li>
		      <li>Catelyn</li>
		      <li>Robb</li>
		      <li>Sansa</li>
		      <li>Brandon</li>
		      <li>Arya</li>
		      <li>Rickon</li>
		    </ul>
		  </div>
		  <div class="mdl-tabs__panel" id="lannisters-panel">
		    <ul>
		      <li>Tywin</li>
		      <li>Cersei</li>
		      <li>Jamie</li>
		      <li>Tyrion</li>
		    </ul>
		  </div>
		  <div class="mdl-tabs__panel" id="targaryens-panel">
		    <ul>
		      <li>Viserys</li>
		      <li>Daenerys</li>
		    </ul>
		  </div>
		</div>
    </div>
  </main>
</div>


</body>
</html>